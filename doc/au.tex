% Template created by Jon Hood

\documentclass[letterpaper, 10pt, twoside]{article}
\usepackage{noto}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage[table]{xcolor}
\usepackage[breaklinks=true]{hyperref}
\usepackage[letterpaper, top=1in, bottom=1in, left=1.5in, right=1in, includeheadfoot]{geometry}
\usepackage{wrapfig}

%                Main Variables
\newcommand{\repdate}{\formatdate{28}{1}{2020}}
\def \ProjectName{Security Technical Implementation Guide Qt Viewer}
\def \ProjectAcronym{STIGQter}
\def \ProjectVersion{1.0.0}

%-------------------------------------------------------------------------------
%                Header & Footer Setup
%-------------------------------------------------------------------------------
\pagestyle{fancy}
\lhead[\thepage]{\includegraphics[height = 2em]{images/STIGQter.pdf}}
\chead{\ProjectName\ --- \ProjectVersion}
\rhead[{\includegraphics[height = 2em]{images/STIGQter.pdf}}]{\thepage}
\cfoot{\ProjectAcronym\ \ProjectVersion}

\fancypagestyle{blank}
{
	\lhead{}
	\chead{}
	\rhead{}
	\cfoot{}
	\lfoot{}
}

%-------------------------------------------------------------------------------
%                Revisions Table
%-------------------------------------------------------------------------------
\definecolor{STIGQterBlue}{RGB}{30,72,124}
\newcounter{RevisionCounter}
\newenvironment{Revision}{
	\begin{center}
		\begin{tabular}{ | c | c | c | p{23em} | }
			\hline
			\multicolumn{4}{| c |}{\cellcolor{STIGQterBlue}\textbf{\textcolor{white}{Revision History}}} \\
			\hline
			\rowcolor{lightgray}
			\textbf{Date} & \textbf{Revision} & \textbf{Revised By} & \textbf{Reason} \\
			\hline
		}{
	\end{tabular}
\end{center}
}
\newcommand{\RevisionEntry}[3]{\stepcounter{RevisionCounter}
	#1 & \Alph{RevisionCounter} & #2 & #3 \\
	\hline}

%-------------------------------------------------------------------------------
%                Title Page
%-------------------------------------------------------------------------------
\newcommand{\headerlogo}{
	\includegraphics[width=.3\linewidth]{images/STIGQter.pdf}\\
	\vspace{.5em}
}
\newcommand{\docline}{\textmd{\textbf{STIGQter Audit and Accountability (AU) Documentation\\}}}
\newcommand{\generator}{Generated By: Jon Hood}
\title{
	\headerlogo
	\docline
	\vspace{.5em}
	\normalsize{\generator}
}

\author{Jon Hood}
\date{\repdate}

%-------------------------------------------------------------------------------
%                PDF metadata
%-------------------------------------------------------------------------------
\hypersetup
{
	pdfauthor= (Jon Hood),
	pdftitle =  (STIGQter Audit and Accountability)
}

\usepackage{attachfile}
\usepackage[backend=biber]{biblatex}
\usepackage{import}
\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage{url}
\addbibresource{sources.bib}
\usepackage{setspace}
\usepackage{array}
\usepackage{booktabs}
\newcolumntype{L}{@{}>{\kern\tabcolsep}l<{\kern\tabcolsep}}
\usepackage{colortbl}
\usepackage{xcolor}
\usepackage{textcomp}
\usepackage{outlines}
\usepackage{setspace}
\usepackage{longtable}
\usepackage{enumitem}
\usepackage{listings}
\usepackage{pgfplots}
\usepgfplotslibrary{fillbetween}
\usepackage{datetime}
\newdateformat{changelog}{\THEMONTH/\THEDAY/\THEYEAR}

\lstdefinestyle{CStyle} {language=C}
\lstdefinestyle{CSharpStyle} {language=[Sharp]C}
\lstdefinestyle{PHPStyle} {language=php}
\lstdefinestyle{JavaStyle} {language=java}
\lstdefinestyle{BashStyle} {language=bash}
\lstdefinestyle{SqlStyle} {language=SQL}

\lstset{language=C}
\lstset{language=[Sharp]C}
\lstset{language=php}
\lstset{language=java}
\lstset{language=bash}
\lstset{language=SQL}

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

%start the document
\begin{document}

%generate a title page
\thispagestyle{blank}
\maketitle
\newpage

\thispagestyle{blank}
This page intentionally left blank for 2-sided printing compatibility.
\newpage

%tell the page counter to restart
\setcounter{page}{1}
\pagenumbering{roman} %use lowercase Roman numerals for page numbers

%Revision History page
\begin{Revision}
\RevisionEntry{\date{\changelog\formatdate{9}{1}{2020}}}{Jon Hood}{Initial Release of AU Policy}
\RevisionEntry{\date{\changelog\formatdate{28}{1}{2020}}}{Jon Hood}{Prepare for 1.0 Release}
\RevisionEntry{\date{\changelog\formatdate{26}{2}{2020}}}{James Shelton}{Update to support not-applicable CCI documentation}
\end{Revision}
\newpage

%generate a table of contents
\setcounter{tocdepth}{2}
\tableofcontents
\cleardoublepage % go to next right-side page

%reset the page counter for the regular pages
\setcounter{page}{1}
\doublespacing
\pagenumbering{arabic} %use standard numbers for the page number

\section{Background}

STIGQter is an open source tool used to perform RMF and STIG compliance mapping. There are no user accounts managed at the application level, and all auditing, logging, accountability, and security controls are handled at the operating system level.

\section{Purpose}

This documentation is meant to satisfy Auditing and Accountability (AU) requirements for RMF and detail what pieces of an AU policy may be covered by this application. Auditing and accountability requirements of roles (Section~\ref{sec:roles}) and their responsibilities (Section~\ref{sec:responsibilities}) provide integrity to the application.

\section{Scope}

The AU policy details the auditing and accountability protections afforded to all users.

\section{Roles}
\label{sec:roles}

The following role(s) are defined as being applicable to STIGQter:
\begin{enumerate}
	\item \textbf{User} -- The user of the software is defined as the individual account given permissions to execute the software.
\end{enumerate}

\section{Responsibilities}
\label{sec:responsibilities}

The user should make sure that their operating environment is secure before installing and using the software. As the operating system manages the user account (and no account management is performed by the application), the application does not define or afford auditing or accountability of any assets.

\section{Management Commitment}

STIGQter development is committed to occur in an approved open source repository for maximum visibility and distribution.

\section{Coordination}

No coordination with other organizations is required to operate this software.

\section{RMF Control Compliance}

\subsection{AU-3 -- Content of Audit Records}
\label{sec:au-3}

\paragraph{Applicable CCIs:} CCI-130, CCI-131, CCI-132, CCI-133, CCI-134, CCI-1487

The application logs HTTP header information, IP addresses, events, start-ups, shut-downs, and other required technical information to trace events. SQL-level logging is turned off by default. If required, SQL queries can also be logged by setting the \texttt{loglevel} variable in the \texttt{Variables} table to a value of 2 or greater.

All logged entries contain the system's local date and time along with the user that is operating the application. If an issue occurs in the Qt framework, the location of the issue is logged. If the logged entry occurs as part of the STIGQter application, when applicable, the function where the log entry is generated is preserved. Log records are given a unique identifier. When an event fails, an additional log record of the failure is created.

\subsubsection{AU-3(1) -- Additional Audit Information}

\paragraph{Applicable CCIs:} CCI-1488

The application logs failures, including errors in STIGâ†”CCI mappings.

\subsubsection{AU-3(2) -- Centralized Management of Planned Audit Record Content}
\label{sec:au-3-2}

\paragraph{Applicable CCIs:} CCI-1844, CCI-1846, CCI-1847

Logs are placed into the \texttt{Log} table. Any SQLite viewing software can review the logs. The recommended tool to use to correlate and manage the logs is the \href{https://sqlitebrowser.org/}{DB Browser for SQLite}.

\subsection{AU-4 -- Audit Storage Capacity}

\subsubsection{AU-4(1) -- Transfer to Alternate Storage}
\label{sec:au-4-1}

\paragraph{Applicable CCIs:} CCI-1851

Since no user, administrative, or logging roles are defined by the application, audit/log retention is at the discretion of the user. If the user would like to off-load the audit records, the user may use the tool(s) defined in Section~\ref{sec:au-3-2} to perform the following actions:
\begin{enumerate}
	\item Export a dump of the \texttt{Log} table
	\item Clear the \texttt{Log} table (\texttt{DELETE FROM Log})
	\item Compact the database
\end{enumerate}

If required by an implementing organization, centralized logging can be enabled by adding a trigger on the \texttt{Log} table:

\begin{lstlisting}[style=SqlStyle]
CREATE TRIGGER CentralLog 
	AFTER INSERT ON Log
BEGIN
	-- Place export logic here, sending NEW record where it needs to go
END;
\end{lstlisting}

Alternatively, a central logging mechanism can be set to connect to the SQLite database and pull the latest logs.

\subsection{AU-5 -- Response to Audit Processing Failures}
\label{sec:au-5}

\paragraph{Applicable CCIs:} CCI-139, CCI-140, CCI-1490, CCI-1572

The application will show an error message when logging failures occur. This message can be ignored if availability of the application is an overriding concern. Software availability concerns are left to the user.

If desired, the user may issue a bug report to STIGQter's issue tracker on GitHub.

\subsubsection{AU-5(1) -- Audit Storage Capacity}

\paragraph{Applicable CCIs:} None

\paragraph{Non-Applicable CCI(s):} CCI-1852, CCI-1853, CCI-1854, CCI-1855

Audit storage control is performed at the operating system level, and the nature of audit record storage is also determined by the underlying operating system.

\subsubsection{AU-5(2) -- Real-Time Alerts}

\paragraph{Applicable CCIs:} CCI-147, CCI-1856, CCI-1857, CCI-1858

The alerts in Section~\ref{sec:au-5} are displayed to the user immediately.

\subsection{AU-6 -- Audit Review, Analysis, and Reporting}

\paragraph{Applicable CCIs:} None

\paragraph{Non-Applicable CCI(s):} CCI-148, CCI-149, CCI-151, CCI-1862, CCI-1863

The application does not implement any audit processing at an application level. Any audit processing is done at the operating system level. Any review, analysis, or reporting of audit generation or audit content must be done manually by the user. The user can define activity to be reviewed and analyzed in the audit contents, but these definitions are not stored or implemented by the application itself. Any anomalous log records should be reported to the project's GitHub issue tracker.

\subsubsection{AU-6(4) -- Central Review and Analysis}

\paragraph{Applicable CCIs:} None

\paragraph{Non-Applicable CCI(s):} CCI-154

Central logging can be configured with the procedures in Section~\ref{sec:au-4-1}, but any review, analysis, or reporting of audit generation or audit content must be done manually by the user. The user can define a centralized entity to review and analyze the audit contents, but this definition is not stored or implemented by the application itself.

\subsubsection{AU-6(10) -- Audit Level Adjustment}

\paragraph{Applicable CCIs:} CCI-1872, CCI-1874

Audit levels may be adjusted using the filtering defined in Section~\ref{sec:au-7}. Audit record reviews, to comply with SV-84919r1\_rule, should occur every 99 years. This is a random value and should be overridden by any program implementing the software.

\subsection{AU-7 -- Audit Reduction and Report Generation}
\label{sec:au-7}

\paragraph{Applicable CCIs:} CCI-1875, CCI-1876, CCI-1877, CCI-1878, CCI-1879, CCI-1880, CCI-1881, CCI-1882

Audit records can be filtered, sorted, and reduced using the tools detailed in Section~\ref{sec:au-3-2}.

\subsubsection{AU-7(1) -- Automatic Processing}

\paragraph{Applicable CCIs:} CCI-158, CCI-1883

The audit record sorting and filtering defined in Section~\ref{sec:au-7} can be automated by the processes defined in Section~\ref{sec:au-4-1}. The fields for the event datetime and contents are defined, a unique id, and the log level identified in Section~\ref{sec:au-12-3}.

\subsection{AU-8 -- Time Stamps}

\paragraph{Applicable CCIs:} CCI-159, CCI-1888, CCI-1889, CCI-1890

The application uses the local system clock for logging. Timestamps are recorded in ISO 8601 format with timezones and to-the-second granularity.

\subsection{AU-9 -- Protection of Audit Information}

\paragraph{Applicable CCIs:} CCI-162, CCI-163, CCI-164, CCI-1493, CCI-1494, CCI-1495

No user management occurs in the application. The user is granted permissions to their files, and the user is defined as the proper role for accessing these records.

\subsubsection{AU-9(2) -- Audit Backup on Separate Physical Systems / Components}

\paragraph{Applicable CCIs:} CCI-1348, CCI-1349, CCI-1575

Backups, including audits, are available on the off-site backup/nightly server documented in the CP policy.

\subsubsection{AU-9(3) -- Cryptographic Protection}

\paragraph{Applicable CCIs:} CCI-1350, CCI-1496

The application builds a SHA3\_256 sum of the database when writing the database out to a file, including the \texttt{Log} table.

\subsection{AU-10 -- Non-Repudiation}

\paragraph{Applicable CCIs:} None

\paragraph{Non-Applicable CCI(s):} CCI-166, CCI-1899

The application does not implement any non-repudiation features. Actions and outputs can be manually assigned non-repudiation factors by the users, but no non-repudiation additions or checks occur at an application level. Non-repudiation measures are external to this accreditation boundary.

\subsection{AU-11 -- Audit Record Retention}

\paragraph{Applicable CCIs:} CCI-167, CCI-168

Audit and log records are retained indefinitely.

\subsection{AU-12 -- Audit Generation}

\paragraph{Applicable CCIs:} CCI-169, CCI-171, CCI-172, CCI-1459, CCI-1910

When an auditable/loggable event is triggered, a new entry in the \texttt{Log} table is created. This includes logs where a header is set. All errors and issues are logged.

\subsection{AU-12(1) -- System-Wide / Time-Correlated Audit Trail}

\paragraph{Applicable CCIs:} CCI-173, CCI-174, CI-1577

All log records are timestamped to the second. Correlation can be managed by the tools identified in Section~\ref{sec:au-3-2} by sorting on the \texttt{Log.when} field.

\subsubsection{AU-12(3) -- Audit Generation | Changes by Authorized Individuals}
\label{au-12-3}

\paragraph{Applicable CCIs:} CCI-1911, CCI-1912, CCI-1913, CCI-1914, CCI-2047

Log records are stored in the SQLite database under the \texttt{Log} table. Users may select only the severity level of errors they wish to see:
\begin{enumerate}
	\item Unhandled Errors
	\item Fatal Errors
	\item Critical Errors
	\item Warnings
	\item Informational Messages
	\item Debugging
\end{enumerate}

Logs should be reviewed by the user as needed.

\subsection{AU-14 -- Session Audit}

\paragraph{Applicable CCIs:} None

\paragraph{Non-Applicable CCI(s):} CCI-1919

The application does not define user accounts or account classifications. Because of the non-privileged nature of the application, the application does not implement user sessions, and therefore does not implement session audits as described in the relevant CCI. The capability of authorized users to capture or record user sessions is external to this accreditation boundary.

\subsubsection{AU-14(1) -- System Start-Up}

\paragraph{Applicable CCIs:} CCI-1464

The application logs the time when it starts.

\clearpage
\printbibliography

\end{document}
